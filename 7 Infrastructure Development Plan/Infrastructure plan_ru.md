**Финальная работа — Инфраструктура небольшой компании**

**1\. Минимальный набор сервисов для инфраструктуры небольшой компании**

Для небольшой компании (до 30 человек, в том числе 2-3 разработчика, DevOps-инженер, бухгалтер, менеджеры), минимально необходимый набор сервисов может выглядеть так:

| Сервис | Назначение |
| --- | --- |
| GitLab / Gitea / GitHub | Хранилище кода, CI/CD |
| Docker + Docker Compose | Упаковка и запуск приложений |
| Prometheus + Grafana | Мониторинг и алерты |
| Alertmanager | Управление уведомлениями от Prometheus |
| Nginx Proxy Manager | Обратный прокси, SSL |
| Vault или Doppler | Безопасное хранение секретов |
| MinIO или S3 | Хранилище для резервных копий и артефактов |
| OpenVPN / WireGuard | Защищённый удалённый доступ |
| Ansible / Terraform | Автоматизация инфраструктуры |
| PostgreSQL / MySQL | Основная база данных |
| Loki / Grafana Alloy | Логирование (поиск и алерты) |

<br>

**2\. Как можно улучшить инфраструктуру**

- Перейти от ручной настройки серверов к полностью автоматизированному развертыванию через Ansible и Terraform.
- Настроить централизованное логирование через Grafana Alloy → Loki.
- Ввести CI/CD пайплайны, в которых:  
  Запускаются тесты,  
  Публикуются Docker-образы,  
  Деплоятся приложения на staging и prod.
- Настроить бекапы в MinIO с версионированием и проверкой восстановления.
- Разделить окружения: staging и production.

- Использовать Python-скрипт для автоматического удаления неиспользуемых Docker-образов из ProGet:  
  Это позволит освободить место в хранилище,  
  Регулярная очистка позволит избежать переполнения и сбоев в CI/CD,  
  Скрипт может работать по cron или запускаться вручную администратором.

<br>

**3\. Источники и цели**

| Источник / Канал | Что полезного нашлось |
| --- | --- |
| Abhishek Veeramalla (YouTube) | Разнообразные мини-проекты: CI/CD, EKS, GitOps, Prometheus, ArgoCD |
| KodeKloud Discord | Реальные практики внедрения Kubernetes, работа с Helm, Ingress, Secrets |
| DevOpsHint.com | Примеры GitLab CI/CD пайплайнов, развертывание ELK Stack |

<br>

**Желаемые результаты:**

| Требование | Цель |
| --- | --- |
| Быстрая поставка через GitLab CI/CD | Автоматизация от коммита до продакшн |
| Централизованное логирование (ELK) | Удобство поиска логов, наблюдаемость, алерты |
| Управление unused образами в ProGet | Оптимизация хранилища Docker-образов |
| Kubernetes с Helm, Ingress, Secrets | Масштабируемость, безопасность, стандартизация |
| Документация и on-boarding | Быстрое вовлечение новых сотрудников |
| Инфраструктура как код (Terraform) | Воспроизводимость, контроль версий |
| Простая диагностика (monitoring stack) | Быстрое обнаружение и устранение проблем |
| Иметь централизованное логирование | Быстрое расследование инцидентов |
| Делать регулярные резервные копии | Восстановление после сбоев или ошибок пользователя |
| Иметь защищённый удалённый доступ | Работа из любой точки мира |
| Быть экономичной и автоматизированной | Снижает затраты времени и денег |

<br>

**4\. План на полгода**

| **Что делаем** | **Короткое описание** | **Цель** | **Время (недели)** | **Очерёдность** | **Комментарий** |
| --- | --- | --- | --- | --- | --- |
| Внедрение Ansible | Описать конфигурации серверов через Ansible | Автоматизация | 2   | 1   | Использовать роли и инвентори |
| Настройка мониторинга | Установить Prometheus, Node Exporter, Grafana, Alertmanager | Обнаружение проблем | 2   | 2   | Настроить алерты по CPU, RAM, диску |
| Внедрение централизованного логгера | Настроить Grafana Alloy + Loki | Поиск по логам, алерты | 1   | 3   | Отправка логов с Docker-контейнеров |
| CI/CD пайплайны в GitLab | Создать пайплайны для тестирования, сборки и развертывания | Быстрая поставка | 3   | 4   | Начать с окружения staging |
| Настройка VPN | Установить OpenVPN + exporter, ограничить доступ к серверам | Безопасный доступ | 1   | 5   | Учет ключей, бекапы конфигов |
| Автоматизация с Terraform | Описать виртуалки и S3/MinIO как код | Ускорение инфраструктурных изменений | 2   | 6   | AWS или локально |
| Бекапы в MinIO | Настроить копии баз данных и конфигов | Восстановление после сбоев | 1   | 7   | Проверка восстановления |
| Ведение документации | Задокументировать весь стек, CI/CD, команды | Онбординг и поддержка | 1   | 8   | Можно сделать в Wiki или mkdocs |
| Изучение Kubernetes (начальный уровень) | Изучение базовых понятий, установка Minikube/Kind | Подготовка к будущему переходу | 2   | 9   | Параллельно с другими задачами |
| Резерв | Время на рефакторинг, отладку, обучение | Гибкость | 2   | 10  | Учитывать форс-мажоры |

Всего: 17 недель реальной работы (~4 месяца)

Оставшиеся 2 месяца — для поддержки, документации, небольших экспериментов, доработки пайплайнов.

<br>

**Вывод**

В течение следующих 6 месяцев при ограниченных ресурсах можно:

• автоматизировать инфраструктуру (Ansible + Terraform)

• внедрить стабильный CI/CD и мониторинг

• наладить безопасность и VPN

• подготовиться к миграции на Kubernetes

• снизить зависимость от ручного администрирования

Такой подход обеспечит надежность, воспроизводимость и масштабируемость без дополнительных затрат.
