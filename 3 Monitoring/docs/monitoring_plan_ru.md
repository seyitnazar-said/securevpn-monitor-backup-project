Проектирование системы мониторинга

**a. Инфраструктурные метрики операционной системы**

Для сбора ключевых метрик на уровне операционной системы оптимальным решением является использование Node Exporter. Этот экспортёр предоставляет в реальном времени данные о загрузке CPU, использовании оперативной памяти, состоянии файловой системы (например, нехватке свободного места), а также о доступности самой виртуальной машины.  
<br/>Для Windows-машин я также использовал Windows Exporter, который аналогично позволяет отслеживать производительность и поведение системы. В случае неожиданной перезагрузки или остановки ВМ, экспортёр зафиксирует аномалию.  
<br/>Важно отметить, что набор метрик от Node Exporter универсален и может быть переиспользован для мониторинга всех виртуальных машин в сети, независимо от назначения или операционной системы.

**b. Мониторинг OpenVPN**

Для мониторинга OpenVPN-сервера я выбрал уже готовое решение — OpenVPN Exporter. Этот экспортёр предоставляет информацию о количестве подключённых клиентов и следит за доступностью сервиса.  
<br/>Кроме того, можно использовать косвенные метрики из системных экспортёров (например, сетевой трафик, состояние портов и процессов), чтобы убедиться в корректной работе OpenVPN даже при ограниченном доступе к его внутренним метрикам.

**c. Алерты для мониторинга виртуальных машин**

Я настроил следующие алерты для контроля состояния ВМ:  
\- Высокая загрузка CPU (средняя занятость более 85% за 1 м).  
\- Недостаток свободной оперативной памяти (менее 10% доступно).  
\- Недостаток свободного места на диске (менее 10% доступно). Исключены временные файловые системы, ssh и сетевые тома.  
\- Недоступность экспортёра (что может указывать на выключенную или зависшую ВМ)  
\- Неожиданная перезагрузка или остановка Windows-машины.

**d. Алерты для мониторинга OpenVPN**

Для OpenVPN настроены следующие алерты:  
\- Сервис OpenVPN остановлен  
\- Резкое снижение числа подключённых клиентов (что может свидетельствовать о проблеме)

**Дополнительно**

Я настроил запуск Node Exporter, Windows Exporter и OpenVPN Exporter как systemd-сервисы. Также был установлен и сконфигурирован Alertmanager, который отправляет уведомления на мой Gmail-аккаунт при срабатывании алертов.